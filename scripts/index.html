<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title></title>
  <script src='http://d3js.org/d3.v3.min.js'></script>
</head>
<body>
<script>
var d = [ { type: 'Q21_PT15', score: 4.631579 },
  { type: 'Q21_PT16', score: 3.333333 },
  { type: 'Q21_PT3', score: 3.261364 },
  { type: 'Q21_PT14', score: 3.25 },
  { type: 'Q21_PT8', score: 3.126786 },
  { type: 'Q21_PT13', score: 3.111111 },
  { type: 'Q21_PT12', score: 2.80303 },
  { type: 'Q21_PT9', score: 2.65 },
  { type: 'Q21_PT7', score: 2.600086 },
  { type: 'Q21_PT1', score: 2.418948 },
  { type: 'Q21_PT2', score: 2.275 },
  { type: 'Q21_PT5', score: 2.021491 },
  { type: 'Q21_PT11', score: 1.6 },
  { type: 'Q21_PT10', score: 1.5 },
  { type: 'Q21_PT6', score: 0 },
  { type: 'Q21_PT4', score: 0 } ];

getChart(window, d);

function getChart(window, data) {

  var d3 =  window.d3;
  var PX_RATIO = 4 / 3;

  var w = 600,
      h = 600;

  var PI = Math.PI;
  var n = data.length;

  function degrees(rad) {
    return rad * 180 / PI;
  }

  var COLOR = '#161f34';

  var CENTER_CIRCLE_RADIUS = 100;
  var CHILD_RADIUS = 30;

  var svg = d3.select('body').append('svg')
    .attr('width', w)
    .attr('height', h);

  svg.append('g').selectAll('line')
      .data(data)
    .enter().append('svg:line')
      .attr('class', 'child')
      .attr('x1', w / 2)
      .attr('y1', h / 2)
      .attr('x2', function(d, i) {
        // draw to the edge of the outer circles
        var angle = (2 * PI / n) * i;
        var x1 = w / 2;
        var y1 = h / 2;
        var x2 = Math.cos((2 * PI / n) * i) * 200 + (h / 2) - Math.cos(100);
        var y2 = Math.sin((2 * PI / n) * i) * 200 + (h / 2) - Math.sin(100);
        var dist = Math.sqrt(Math.pow((x1 - x2), 2) + Math.pow((y1 - y2), 2));
        var radius = CHILD_RADIUS;
        var hypo = dist - radius;
        var x = x1 + hypo * Math.cos(angle);
        return x;
      })
      .attr('y2', function(d, i) {
        // draw to the edge of the outer circles
        var angle = (2 * PI / n) * i;
        var x1 = w / 2;
        var y1 = h / 2;
        var x2 = Math.cos((2 * PI / n) * i) * 200 + (h / 2) - Math.cos(100);
        var y2 = Math.sin((2 * PI / n) * i) * 200 + (h / 2) - Math.sin(100);
        var dist = Math.sqrt(Math.pow((x1 - x2), 2) + Math.pow((y1 - y2), 2));
        var radius = CHILD_RADIUS;
        var hypo = dist - radius;
        var y = y1 + hypo * Math.sin(angle);
        return y;
      })
      .attr('stroke', '#000')
      .attr("stroke-width", 2);

  svg.append('g').append('circle')
    .attr('cx', w / 2)
    .attr('cy', h / 2)
    .attr('r', CENTER_CIRCLE_RADIUS)
    .attr('fill', COLOR);

  svg.append('g').selectAll('circle.child')
      .data(data)
    .enter().append('svg:circle')
      .attr('class', 'child')
      .attr('cx', function(d, i) { return Math.cos((2 * PI / n) * i - PI / 2) * 200 + (w / 2); })
      .attr('cy', function(d, i) { return Math.sin((2 * PI / n) * i - PI / 2) * 200 + (h / 2); })
      .attr('r', CHILD_RADIUS)
      .attr('fill', COLOR)
      .attr('opacity', function(d, i) { return 1 - (0.5 * (i / n)); });

  svg.append('g').selectAll('.label')
      .data(data)
    .enter().append('text')
      .attr('x', function(d, i) { return Math.cos((2 * PI / n) * i - PI / 2) * 200 + (w / 2); })
      .attr('y', function(d, i) { return Math.sin((2 * PI / n) * i - PI / 2) * 200 + (h / 2); })
      .text(function(d) { return d.type; });

  svg.append('g')
    .append('text')
      .text('Influence in Addressing')
      .attr('x', w / 2)
      .attr('y', h / 2);
  svg.append('g')
    .append('text')
      .text('Different Problem Areas')
      .attr('x', w / 2)
      .attr('y', 20 + h / 2);

  d3.selectAll('text')
    .style('fill', '#fff')
    .style('font-family', 'Open Sans')
    .style('text-anchor', 'middle');

  return window.document.getElementsByTagName('svg')[0];
}
</script>
</body>
</html>
