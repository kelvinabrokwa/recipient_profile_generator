<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title></title>
  <script src='http://d3js.org/d3.v3.min.js'></script>
</head>
<body>
<script>

getChart(window);

function getChart(window, data) {

  var d3 =  window.d3;
  var PX_RATIO = 4 / 3;

  data = d3.range(16).map(function(i) {
    return { type: i }
  });

  var w = 700,
      h = 700;

  var PI = Math.PI;
  var n = data.length;

  function degrees(rad) {
    return rad * 180 / PI;
  }

  var COLOR = '#161f34';

  var CHILD_RADIUS = 30;

  var svg = d3.select('body').append('svg')
    .attr('width', w)
    .attr('height', h);

  svg.selectAll('line')
      .data(data)
    .enter().append('svg:line')
      .attr('class', 'child')
      .attr('x1', w / 2)
      .attr('y1', h / 2)
      .attr('x2', function(d, i) {
        var angle = (2 * PI / n) * i;
        var x1 = w / 2;
        var y1 = h / 2;
        var x2 = Math.cos((2 * PI / n) * i) * 200 + (h / 2) - Math.cos(100);
        var y2 = sm_center_y = Math.sin((2 * PI / n) * i) * 200 + (h / 2) - Math.sin(100);
        var dist = Math.sqrt(Math.pow((x1 - x2), 2) + Math.pow((y1 - y2), 2));
        var radius = CHILD_RADIUS;
        var hypo = dist - radius;
        var x = x1 + hypo * Math.cos(angle);
        return x;
        //return Math.cos((2 * PI / n) * i) * 200 + (h / 2) - Math.cos(100);
      })
      .attr('y2', function(d, i) {
        var angle = (2 * PI / n) * i;
        var x1 = w / 2;
        var y1 = h / 2;
        var x2 = Math.cos((2 * PI / n) * i) * 200 + (h / 2) - Math.cos(100);
        var y2 = sm_center_y = Math.sin((2 * PI / n) * i) * 200 + (h / 2) - Math.sin(100);
        var dist = Math.sqrt(Math.pow((x1 - x2), 2) + Math.pow((y1 - y2), 2));
        var radius = CHILD_RADIUS;
        var hypo = dist - radius;
        var y = y1 + hypo * Math.sin(angle);
        return y;
        //return Math.sin((2 * PI / n) * i) * 200 + (h / 2) - Math.sin(100);
      })
      .attr('stroke', '#000')
      .attr("stroke-width", 2);

  svg.append('circle')
    .attr('cx', w / 2)
    .attr('cy', h / 2)
    .attr('r', 100)
    .attr('fill', COLOR);

  svg.selectAll('circle.child')
      .data(data)
    .enter().append('svg:circle')
      .attr('class', 'child')
      .attr('cx', function(d, i) { return Math.cos((2 * PI / n) * i) * 200 + (w / 2); })
      .attr('cy', function(d, i) { return Math.sin((2 * PI / n) * i) * 200 + (h / 2); })
      .attr('r', CHILD_RADIUS)
      .attr('fill', COLOR)
      .attr('opacity', function(d, i) { return 1 - (0.5 * (i / n)); });

  return window.document.getElementsByTagName('svg')[0];
}
</script>
</body>
</html>
